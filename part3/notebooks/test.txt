         1267 function calls in 152.905 seconds

   Ordered by: internal time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       25  150.103    6.004  150.103    6.004 {method 'acquire' of '_thread.lock' objects}
        5    2.507    0.501    2.507    0.501 {built-in method time.sleep}
        1    0.233    0.233    0.235    0.235 {method 'read' of '_io.TextIOWrapper' objects}
        1    0.051    0.051    0.051    0.051 /opt/conda/lib/python3.10/json/decoder.py:343(raw_decode)
        1    0.003    0.003    0.003    0.003 {built-in method io.open}
        1    0.003    0.003    0.003    0.003 {built-in method _codecs.utf_8_decode}
        5    0.001    0.000    0.001    0.000 /opt/conda/lib/python3.10/json/encoder.py:204(iterencode)
        1    0.001    0.001    0.287    0.287 /opt/conda/lib/python3.10/json/__init__.py:274(load)
       11    0.000    0.000    0.000    0.000 {method 'sendall' of '_socket.socket' objects}
        5    0.000    0.000  150.104   30.021 /opt/conda/lib/python3.10/site-packages/kafka/producer/record_accumulator.py:520(await_flush_completion)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/zmq/sugar/socket.py:613(send)
        1    0.000    0.000  152.905  152.905 /tmp/ipykernel_87/3723525397.py:1(produce)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/partitioner/default.py:36(murmur2)
        5    0.000    0.000    0.002    0.000 /opt/conda/lib/python3.10/site-packages/kafka/producer/kafka.py:538(send)
        5    0.000    0.000    0.001    0.000 /opt/conda/lib/python3.10/site-packages/kafka/producer/record_accumulator.py:200(append)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/logging/__init__.py:283(__init__)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/record/legacy_records.py:391(_encode_msg)
       20    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/ipykernel/iostream.py:535(write)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/posixpath.py:117(splitext)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/uuid.py:138(__init__)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/threading.py:236(__init__)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/record/legacy_records.py:352(append)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.compile}
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/threading.py:545(__init__)
        5    0.000    0.000  150.106   30.021 /tmp/ipykernel_87/661153088.py:1(publish_message)
        5    0.000    0.000  150.103   30.021 /opt/conda/lib/python3.10/threading.py:288(wait)
        5    0.000    0.000    0.001    0.000 /opt/conda/lib/python3.10/json/encoder.py:182(encode)
        5    0.000    0.000    0.000    0.000 {built-in method binascii.crc32}
        5    0.000    0.000    0.000    0.000 {built-in method posix.urandom}
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/uuid.py:279(__str__)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/producer/future.py:11(__init__)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/logging/__init__.py:1549(findCaller)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/uuid.py:718(uuid4)
        5    0.000    0.000    0.001    0.000 /opt/conda/lib/python3.10/json/__init__.py:183(dumps)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/producer/record_accumulator.py:57(try_append)
        1    0.000    0.000    0.000    0.000 {method '__exit__' of '_io._IOBase' objects}
       30    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/logging/__init__.py:1724(isEnabledFor)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/ipykernel/iostream.py:203(schedule)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/producer/record_accumulator.py:39(__init__)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.print}
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/producer/kafka.py:664(_wait_on_metadata)
        5    0.000    0.000  150.103   30.021 /opt/conda/lib/python3.10/threading.py:589(wait)
       61    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       11    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/client_async.py:929(wakeup)
       10    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/producer/record_accumulator.py:24(increment)
       10    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/cluster.py:106(partitions_for_topic)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/producer/kafka.py:716(_partition)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/record/memory_records.py:118(__init__)
       15    0.000    0.000    0.000    0.000 {built-in method _struct.pack_into}
        1    0.000    0.000    0.003    0.003 /opt/conda/lib/python3.10/codecs.py:319(decode)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/cluster.py:119(available_partitions_for_topic)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/logging/__init__.py:1600(_log)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/producer/future.py:32(__init__)
       92    0.000    0.000    0.000    0.000 {built-in method builtins.len}
       10    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/future.py:12(__init__)
       20    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/ipykernel/iostream.py:444(_is_master_process)
        5    0.000    0.000  150.104   30.021 /opt/conda/lib/python3.10/site-packages/kafka/producer/kafka.py:624(flush)
       25    0.000    0.000    0.000    0.000 {built-in method posix.getpid}
       25    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/logging/__init__.py:1455(debug)
        5    0.000    0.000    0.000    0.000 {method 'extend' of 'bytearray' objects}
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/logging/__init__.py:1479(warning)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/producer/buffer.py:38(allocate)
       20    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/ipykernel/iostream.py:465(_schedule_flush)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/posixpath.py:140(basename)
       10    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/record/legacy_records.py:486(record_size)
       10    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/producer/record_accumulator.py:29(decrement)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/producer/kafka.py:529(_estimate_size_in_bytes)
        5    0.000    0.000    0.000    0.000 {built-in method builtins.sorted}
        1    0.000    0.000    0.051    0.051 /opt/conda/lib/python3.10/json/decoder.py:332(decode)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/logging/__init__.py:160(<lambda>)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/producer/record_accumulator.py:580(add)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/ipykernel/iostream.py:90(_event_pipe)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/threading.py:1169(is_alive)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/producer/sender.py:173(add_topic)
        1    0.000    0.000    0.051    0.051 /opt/conda/lib/python3.10/json/__init__.py:299(loads)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/record/util.py:131(calc_crc32)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/logging/__init__.py:1680(callHandlers)
        5    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
       57    0.000    0.000    0.000    0.000 {method '__exit__' of '_thread.lock' objects}
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/threading.py:276(_acquire_restore)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/logging/__init__.py:1585(makeRecord)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/logging/__init__.py:119(getLevelName)
       11    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/producer/sender.py:331(wakeup)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/vendor/six.py:592(iteritems)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/record/legacy_records.py:346(__init__)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/genericpath.py:121(_splitext)
        5    0.000    0.000  150.103   30.021 /opt/conda/lib/python3.10/site-packages/kafka/producer/future.py:26(wait)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/cluster.py:131(<listcomp>)
        5    0.000    0.000    0.000    0.000 <string>:1(<lambda>)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/record/legacy_records.py:503(estimate_size_in_bytes)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/partitioner/default.py:15(__call__)
       15    0.000    0.000    0.000    0.000 {method 'rfind' of 'str' objects}
       11    0.000    0.000    0.000    0.000 {built-in method _thread.allocate_lock}
        2    0.000    0.000  152.908   76.454 /opt/conda/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3424(run_code)
       25    0.000    0.000    0.000    0.000 {built-in method time.time}
        2    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/codeop.py:117(__call__)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/record/memory_records.py:176(is_full)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/record/memory_records.py:137(append)
        2    0.000    0.000    0.000    0.000 {method 'match' of 're.Pattern' objects}
        1    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/codecs.py:309(__init__)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.max}
       20    0.000    0.000    0.000    0.000 {method 'write' of '_io.StringIO' objects}
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/producer/record_accumulator.py:588(all)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/record/legacy_records.py:521(__init__)
        5    0.000    0.000    0.000    0.000 {method 'pack_into' of '_struct.Struct' objects}
        5    0.000    0.000    0.000    0.000 {built-in method from_bytes}
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/future.py:48(add_callback)
        5    0.000    0.000    0.000    0.000 {built-in method builtins.all}
       10    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/record/legacy_records.py:495(record_overhead)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/future.py:22(failed)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/producer/kafka.py:521(_max_usable_produce_magic)
        1    0.000    0.000    0.000    0.000 /tmp/ipykernel_87/3723525397.py:1(<module>)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/posixpath.py:52(normcase)
        5    0.000    0.000    0.000    0.000 {method 'count' of 'list' objects}
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/logging/__init__.py:1626(handle)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/producer/record_accumulator.py:513(begin_flush)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/threading.py:1102(_wait_for_tstate_lock)
        5    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0xaaaaca41ee58}
       15    0.000    0.000    0.000    0.000 {method 'append' of 'collections.deque' objects}
       25    0.000    0.000    0.000    0.000 {method '__exit__' of '_thread.RLock' objects}
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/threading.py:267(__exit__)
        5    0.000    0.000    0.000    0.000 {built-in method sys._getframe}
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/threading.py:1430(current_thread)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/record/legacy_records.py:479(size_in_bytes)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/posixpath.py:41(_get_sep)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/threading.py:264(__enter__)
        2    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/contextlib.py:102(__init__)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/threading.py:279(_is_owned)
        4    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/IPython/core/compilerop.py:180(extra_flags)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/future.py:57(add_errback)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/threading.py:1129(name)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/threading.py:273(_release_save)
       15    0.000    0.000    0.000    0.000 {built-in method posix.fspath}
        1    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/codecs.py:260(__init__)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/logging/__init__.py:806(filter)
        2    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/traitlets/traitlets.py:654(get)
       10    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/producer/kafka.py:651(_ensure_valid_record_size)
        4    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        2    0.000    0.000  152.908   76.454 {built-in method builtins.exec}
        2    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/traitlets/traitlets.py:692(__get__)
       10    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/producer/kafka.py:709(_serialize)
        2    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/contextlib.py:279(helper)
        2    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/contextlib.py:130(__enter__)
       10    0.000    0.000    0.000    0.000 {method 'keys' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'startswith' of 'str' objects}
        4    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        5    0.000    0.000    0.000    0.000 {method 'popleft' of 'collections.deque' objects}
        2    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/contextlib.py:139(__exit__)
        1    0.000    0.000    0.003    0.003 /opt/conda/lib/python3.10/site-packages/IPython/core/interactiveshell.py:273(_modified_open)
        5    0.000    0.000    0.000    0.000 {built-in method builtins.iter}
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/record/legacy_records.py:472(size)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/producer/kafka.py:593(<genexpr>)
       10    0.000    0.000    0.000    0.000 {built-in method _thread.get_ident}
        2    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3376(compare)
        6    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        5    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
        5    0.000    0.000    0.000    0.000 {method '__enter__' of '_thread.lock' objects}
        1    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/logging/__init__.py:219(_acquireLock)
        1    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/logging/__init__.py:1710(getEffectiveLevel)
       10    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
        5    0.000    0.000    0.000    0.000 {method 'join' of 'str' objects}
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/threading.py:553(is_set)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/logging/__init__.py:2213(handle)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/record/legacy_records.py:527(offset)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/record/legacy_records.py:535(size)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/record/legacy_records.py:539(timestamp)
        5    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/kafka/record/legacy_records.py:531(crc)
        1    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/logging/__init__.py:228(_releaseLock)
        2    0.000    0.000    0.000    0.000 {method 'end' of 're.Match' objects}
        5    0.000    0.000    0.000    0.000 {method 'release' of '_thread.lock' objects}
        2    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/site-packages/IPython/core/interactiveshell.py:1227(user_global_ns)
        1    0.000    0.000    0.000    0.000 /opt/conda/lib/python3.10/logging/__init__.py:1307(disable)
        1    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}


